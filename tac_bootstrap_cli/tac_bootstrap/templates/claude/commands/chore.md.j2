# Chore Planning

Create a plan to complete a maintenance task (chore) in {{ config.project.name }} using the specified format.

## Variables
issue_number: $1
adw_id: $2
issue_json: $3

## Instructions

- IMPORTANT: You are writing a plan to complete a chore for {{ config.project.name }}.
- The plan should be simple but precise to avoid wasting time.
- CRITICAL: Create the plan using RELATIVE path `{{ config.paths.specs_dir }}/issue-{issue_number}-adw-{adw_id}-chore_planner-{descriptive-name}.md`
- CRITICAL: NEVER use absolute paths (starting with /). ALWAYS use relative paths to current directory.
- CRITICAL: When using the Write tool, use ONLY `{{ config.paths.specs_dir }}/filename.md`, NOT `/Users/.../{{ config.paths.specs_dir }}/filename.md`
- Investigate the codebase and create a plan to complete the chore.
- IMPORTANT: Replace each <placeholder> in the format with real values.
- Use the reasoning model: think carefully about the steps.
- `{{ config.paths.adws_dir }}/*.py` are uv single-file scripts. Run with `uv run <script_name>`.

## Relevant Files

Key files for {{ config.project.name }}:

- `CLAUDE.md` - Agent guide
- `config.yml` - Project configuration
{% if config.paths.app_root %}
- `{{ config.paths.app_root }}/` - Application source code
{% endif %}
- `{{ config.paths.scripts_dir }}/` - Utility scripts
- `{{ config.paths.adws_dir }}/` - AI Developer Workflows

Read `.claude/commands/conditional_docs.md` for additional documentation.

## Plan Format

```md
# Chore: <chore name>

## Metadata
issue_number: `{issue_number}`
adw_id: `{adw_id}`
issue_json: `{issue_json}`

## Chore Description
<describe the chore in detail>

## Relevant Files
Files to complete the chore:

<list relevant files with description of why they are relevant>

### New Files
<list new files if required>

## Step by Step Tasks
IMPORTANT: Execute each step in order.

### Task 1: <name>
- <detail>

### Task 2: <name>
- <detail>

<The last step should execute Validation Commands>

## Validation Commands
Run all commands to validate with zero regressions:

{% if config.commands.test %}
- `{{ config.commands.test }}` - Run tests
{% endif %}
{% if config.commands.lint %}
- `{{ config.commands.lint }}` - Linting
{% endif %}

## Notes
<additional notes or relevant context>
```

## Chore
Extract chore details from the `issue_json` variable (parse JSON and use title and body fields).

## Report

CRITICAL OUTPUT FORMAT - You MUST follow this exactly:

1. First, check if a plan file already exists in `{{ config.paths.specs_dir }}/` matching pattern: `issue-{issue_number}-adw-{adw_id}-*.md`
2. If plan file EXISTS: Return ONLY the relative path, nothing else
3. If plan file does NOT exist: Create it using RELATIVE PATH (e.g., `{{ config.paths.specs_dir }}/filename.md`), then return ONLY the path

CRITICAL FILE CREATION RULES:
- When using the Write tool, use RELATIVE paths only: `{{ config.paths.specs_dir }}/filename.md`
- NEVER use absolute paths like `/Users/.../{{ config.paths.specs_dir }}/filename.md`
- The file will be created in the current working directory

YOUR FINAL OUTPUT MUST BE EXACTLY ONE LINE containing only the RELATIVE path like:
```
{{ config.paths.specs_dir }}/issue-37-adw-e4dc9574-chore_planner-chore-name.md
```

DO NOT include:
- Any explanation or commentary
- Phrases like "Perfect!", "I found...", "The plan file is at..."
- Markdown formatting around the path
- Multiple lines
- Absolute paths (starting with /)

ONLY output the bare RELATIVE path. This is machine-parsed.
