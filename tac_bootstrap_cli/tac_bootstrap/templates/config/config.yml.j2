# TAC Bootstrap Configuration
# Generated by TAC Bootstrap v{{ config.version }}
# Documentation: https://github.com/celes-app/tac-cli-dist

# TAC Bootstrap release version (e.g., 0.9.8)
version: "{{ config.version }}"

# Configuration schema version (internal)
schema_version: {{ config.schema_version }}

project:
  name: "{{ config.project.name }}"
  mode: "{{ config.project.mode.value }}"
  repo_root: "{{ config.project.repo_root }}"
  language: "{{ config.project.language.value }}"
{% if config.project.framework %}
  framework: "{{ config.project.framework.value }}"
{% endif %}
  architecture: "{{ config.project.architecture.value }}"
  package_manager: "{{ config.project.package_manager.value }}"

paths:
  app_root: "{{ config.paths.app_root }}"
  agentic_root: "{{ config.paths.agentic_root }}"
  prompts_dir: "{{ config.paths.prompts_dir }}"
  adws_dir: "{{ config.paths.adws_dir }}"
  specs_dir: "{{ config.paths.specs_dir }}"
  logs_dir: "{{ config.paths.logs_dir }}"
  scripts_dir: "{{ config.paths.scripts_dir }}"
  worktrees_dir: "{{ config.paths.worktrees_dir }}"

commands:
  start: "{{ config.commands.start }}"
  test: "{{ config.commands.test }}"
{% if config.commands.lint %}
  lint: "{{ config.commands.lint }}"
{% endif %}
{% if config.commands.typecheck %}
  typecheck: "{{ config.commands.typecheck }}"
{% endif %}
{% if config.commands.format %}
  format: "{{ config.commands.format }}"
{% endif %}
{% if config.commands.build %}
  build: "{{ config.commands.build }}"
{% endif %}

agentic:
  provider: "{{ config.agentic.provider.value }}"
  target_branch: "{{ config.agentic.target_branch | default('main') }}"
  model_policy:
    default: "{{ config.agentic.model_policy.default }}"
    heavy: "{{ config.agentic.model_policy.heavy }}"
    fallback: "{{ config.agentic.model_policy.fallback | default('haiku') }}"  # Fallback model when quota is exhausted
  worktrees:
    enabled: {{ config.agentic.worktrees.enabled | lower }}
    max_parallel: {{ config.agentic.worktrees.max_parallel }}
    naming: "{{ config.agentic.worktrees.naming }}"
  logging:
    level: "{{ config.agentic.logging.level }}"
    capture_agent_transcript: {{ config.agentic.logging.capture_agent_transcript | lower }}
    run_id_strategy: "{{ config.agentic.logging.run_id_strategy.value }}"
  safety:
    require_tests_pass: {{ config.agentic.safety.require_tests_pass | lower }}
    require_review_artifacts: {{ config.agentic.safety.require_review_artifacts | lower }}
{% if config.agentic.safety.allowed_paths %}
    allowed_paths:
{% for path in config.agentic.safety.allowed_paths %}
      - "{{ path }}"
{% endfor %}
{% endif %}
{% if config.agentic.safety.forbidden_paths %}
    forbidden_paths:
{% for path in config.agentic.safety.forbidden_paths %}
      - "{{ path }}"
{% endfor %}
{% endif %}
  workflows:
    default: "{{ config.agentic.workflows.default.value }}"
    available:
{% for workflow in config.agentic.workflows.available %}
      - "{{ workflow.value }}"
{% endfor %}
  token_optimization:
    max_issue_body_length: {{ config.agentic.token_optimization.max_issue_body_length | default(2000) }}  # Truncate issue body to reduce token usage
    max_file_reference_size: {{ config.agentic.token_optimization.max_file_reference_size | default(5000) }}  # Max chars per referenced file
    max_clarification_length: {{ config.agentic.token_optimization.max_clarification_length | default(1000) }}  # Max chars for clarification responses
    max_docs_planning: {{ config.agentic.token_optimization.max_docs_planning | default(2) }}  # Max documentation files to load in planning phase
    max_summary_tokens_planning: {{ config.agentic.token_optimization.max_summary_tokens_planning | default(200) }}  # Max tokens per doc summary in planning
    max_file_references: {{ config.agentic.token_optimization.max_file_references | default(3) }}  # Max number of files to load from issue references
    max_screenshots: {{ config.agentic.token_optimization.max_screenshots | default(3) }}  # Max screenshots to upload in review phase

claude:
  settings:
    project_name: "{{ config.claude.settings.project_name }}"
    preferred_style: "{{ config.claude.settings.preferred_style }}"
    allow_shell: {{ config.claude.settings.allow_shell | lower }}
  commands:
    prime: "{{ config.claude.commands.prime }}"
    start: "{{ config.claude.commands.start }}"
    build: "{{ config.claude.commands.build }}"
    test: "{{ config.claude.commands.test }}"
    review: "{{ config.claude.commands.review }}"
    ship: "{{ config.claude.commands.ship }}"

templates:
  plan_template: "{{ config.templates.plan_template }}"
  chore_template: "{{ config.templates.chore_template }}"
  feature_template: "{{ config.templates.feature_template }}"
  bug_template: "{{ config.templates.bug_template }}"
  review_template: "{{ config.templates.review_template }}"

{% if config.orchestrator %}
orchestrator:
  enabled: {{ config.orchestrator.enabled | lower }}
  api_base_url: "{{ config.orchestrator.api_base_url }}"
  ws_base_url: "{{ config.orchestrator.ws_base_url }}"
  frontend_port: {{ config.orchestrator.frontend_port }}
  websocket_port: {{ config.orchestrator.websocket_port }}
  database_url: "{{ config.orchestrator.database_url }}"
  polling_interval: {{ config.orchestrator.polling_interval }}
{% endif %}

bootstrap:
  create_git_repo: {{ config.bootstrap.create_git_repo | lower }}
  initial_commit: {{ config.bootstrap.initial_commit | lower }}
  license: "{{ config.bootstrap.license }}"
  readme: {{ config.bootstrap.readme | lower }}

# TAC Bootstrap Metadata (auto-generated)
{% if config.metadata %}
metadata:
  generated_at: "{{ config.metadata.generated_at }}"
  generated_by: "{{ config.metadata.generated_by }}"
  schema_version: {{ config.metadata.schema_version }}
  last_upgrade: {% if config.metadata.last_upgrade %}"{{ config.metadata.last_upgrade }}"{% else %}null{% endif %}
{% endif %}
