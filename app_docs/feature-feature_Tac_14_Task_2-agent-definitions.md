---
doc_type: feature
adw_id: feature_Tac_14_Task_2
date: 2026-02-04
idk:
  - agent-definition
  - yaml-frontmatter
  - jinja2-template
  - subagent-orchestration
  - build-agent
  - planner-agent
  - scout-agent
  - dual-location-pattern
tags:
  - feature
  - tac-14
  - orchestration
related_code:
  - .claude/agents/build-agent.md
  - .claude/agents/planner.md
  - .claude/agents/scout-report-suggest.md
  - .claude/agents/scout-report-suggest-fast.md
  - .claude/agents/playwright-validator.md
  - .claude/agents/meta-agent.md
  - .claude/agents/docs-scraper.md
  - tac_bootstrap_cli/tac_bootstrap/templates/claude/agents/build-agent.md.j2
  - tac_bootstrap_cli/tac_bootstrap/templates/claude/agents/planner.md.j2
  - tac_bootstrap_cli/tac_bootstrap/templates/claude/agents/scout-report-suggest.md.j2
  - tac_bootstrap_cli/tac_bootstrap/templates/claude/agents/scout-report-suggest-fast.md.j2
  - tac_bootstrap_cli/tac_bootstrap/templates/claude/agents/playwright-validator.md.j2
  - tac_bootstrap_cli/tac_bootstrap/templates/claude/agents/meta-agent.md.j2
  - tac_bootstrap_cli/tac_bootstrap/templates/claude/agents/docs-scraper.md.j2
  - adws/adw_modules/agent.py
  - adws/adw_modules/workflow_ops.py
  - adws/adw_plan_iso.py
  - adws/adw_build_iso.py
  - tac_bootstrap_cli/tac_bootstrap/application/scaffold_service.py
---

# Agent Definitions Implementation (TAC-14)

**ADW ID:** feature_Tac_14_Task_2
**Date:** 2026-02-04
**Specification:** specs/issue-619-adw-feature_Tac_14_Task_2-sdlc_planner-agent-definitions.md

## Overview

This feature implements a complete multi-agent orchestration system for TAC Bootstrap following the TAC-14 "dual location" pattern. It introduces 7 specialized agent definitions that enable both tac_bootstrap itself and projects generated by the CLI to leverage sophisticated agent orchestration capabilities. These agents work in concert to handle planning, implementation, scouting, validation, and documentation tasks through a coordinated workflow.

## What Was Built

The implementation adds 7 specialized agent types with two implementations each (BASE + TEMPLATE):

1. **build-agent** - Parallel file implementation specialist for delegated single-file writing
2. **planner** - Strategic planning agent that delegates to `/plan` command
3. **scout-report-suggest** - Full codebase exploration and analysis (opus model)
4. **scout-report-suggest-fast** - Fast codebase scouting using haiku model
5. **playwright-validator** - E2E validation specialist for browser testing
6. **meta-agent** - Agent definition generator from specifications
7. **docs-scraper** - Documentation scraping specialist using firecrawl-mcp

Each agent has:
- BASE implementation in `.claude/agents/` for tac_bootstrap's own development
- Jinja2 template in `tac_bootstrap_cli/tac_bootstrap/templates/claude/agents/` for project generation
- YAML frontmatter with metadata (name, description, tools, model, color)
- Specialized instructions and workflow definitions
- Integration with ADW workflows and slash commands

## Technical Implementation

### Files Modified

**BASE Agent Definitions:**
- `.claude/agents/build-agent.md` - Changed model from sonnet to opus for complex file implementation
- `.claude/agents/planner.md` - New lightweight planning agent using opus
- `.claude/agents/scout-report-suggest.md` - Minor updates to formatting
- `.claude/agents/scout-report-suggest-fast.md` - Minor updates to formatting
- `.claude/agents/playwright-validator.md` - Major refactor from simple to comprehensive E2E testing agent
- `.claude/agents/meta-agent.md` - Streamlined from verbose to focused agent generator
- `.claude/agents/docs-scraper.md` - Simplified to focused documentation scraping specialist

**Template Files (Jinja2):**
- `tac_bootstrap_cli/tac_bootstrap/templates/claude/agents/build-agent.md.j2` - Template version with same model change
- `tac_bootstrap_cli/tac_bootstrap/templates/claude/agents/planner.md.j2` - Template version of planning agent
- `tac_bootstrap_cli/tac_bootstrap/templates/claude/agents/scout-report-suggest.md.j2` - Template version
- `tac_bootstrap_cli/tac_bootstrap/templates/claude/agents/scout-report-suggest-fast.md.j2` - Template version
- `tac_bootstrap_cli/tac_bootstrap/templates/claude/agents/playwright-validator.md.j2` - Template version
- `tac_bootstrap_cli/tac_bootstrap/templates/claude/agents/meta-agent.md.j2` - Template version
- `tac_bootstrap_cli/tac_bootstrap/templates/claude/agents/docs-scraper.md.j2` - Template version

**ADW Workflow Integration:**
- `adws/adw_modules/agent.py` - Updated TAC version comments (TAC-10, TAC-11, TAC-12, TAC-13)
- `adws/adw_modules/workflow_ops.py` - Updated function docstrings with correct TAC versions
- `adws/adw_plan_iso.py` - Reordered clarification phase and updated TAC version comments
- `adws/adw_build_iso.py` - Integration with build-agent for parallel implementation
- `adws/adw_sdlc_iso.py` - Updated TAC version references
- `adws/adw_sdlc_zte_iso.py` - Updated TAC version references

**Scaffold Service:**
- `tac_bootstrap_cli/tac_bootstrap/application/scaffold_service.py` - Agent registration already existed (lines 459-475), templates now match

**Configuration:**
- `.mcp.json` - MCP server configuration for firecrawl integration
- `playwright-mcp-config.json` - Playwright MCP configuration for E2E testing

### Key Changes

1. **Agent Definition Structure**: All agents follow consistent YAML frontmatter format with required fields (name, description, tools, model, color)

2. **Model Selection Strategy**:
   - `build-agent`: opus (complex file implementation)
   - `planner`: opus (strategic planning)
   - `scout-report-suggest`: opus (thorough codebase analysis)
   - `scout-report-suggest-fast`: haiku (quick scouting)
   - `playwright-validator`: sonnet (balanced E2E testing)
   - `meta-agent`: sonnet (agent generation)
   - `docs-scraper`: sonnet (documentation scraping)

3. **Workflow Integration**: Agents are invoked through ADW workflows via the `prompt_claude_code` function in `adws/adw_modules/agent.py`

4. **TAC Version Standardization**: Updated comments throughout ADW modules to use specific TAC version numbers (TAC-10, TAC-11, TAC-12, TAC-13, TAC-14) instead of generic "TAC" references

5. **Template Rendering**: Scaffold service registers all 7 agents for template rendering during project generation (scaffold_service.py:459-475)

## How to Use

### Using Agents in tac_bootstrap Development

The BASE agent definitions in `.claude/agents/` are available for immediate use in tac_bootstrap development:

```bash
# Use the planner agent to create implementation plans
# In Claude Code chat, delegate planning tasks to the planner agent

# Use build-agent for parallel file implementation
# The build-agent is automatically invoked by /build_in_parallel command

# Use scout agents for codebase exploration
# Scout agents are invoked via /scout command or ADW workflows with --scout flag
```

### Generating Projects with Agent Definitions

When generating new projects with tac-bootstrap CLI, all 7 agent definitions are automatically included:

```bash
# Generate a new project
cd tac_bootstrap_cli
uv run tac-bootstrap init my-project

# The generated project will have all agent definitions in:
# my-project/.claude/agents/
```

### ADW Workflow Integration

Agent definitions are integrated into ADW workflows:

```bash
# Planning with codebase scouting (uses scout-report-suggest agent)
uv run adws/adw_plan_iso.py --issue 123 --scout --scout-scale medium

# Planning with parallel scouts (TAC-12)
uv run adws/adw_plan_iso.py --issue 123 --use-plan-w-scouts

# Build implementation in parallel (uses build-agent)
uv run adws/adw_build_iso.py --issue 123 --use-parallel-build

# Full SDLC with agent orchestration
uv run adws/adw_sdlc_iso.py --issue 123 --scout --use-parallel-build
```

## Configuration

### YAML Frontmatter Structure

Each agent definition follows this structure:

```yaml
---
name: agent-name
description: Brief description of agent purpose and when to use
tools: Tool1, Tool2, Tool3  # Available tools for the agent
model: opus|sonnet|haiku    # Model selection based on task complexity
color: blue|green|purple    # Visual identifier
---
```

### MCP Server Configuration

The docs-scraper and playwright-validator agents require MCP server configuration:

- `.mcp.json` - Firecrawl MCP server for documentation scraping
- `playwright-mcp-config.json` - Playwright MCP server for E2E browser testing

### Scaffold Service Registration

Agents are registered in `scaffold_service.py` lines 459-475:

```python
agents = [
    ("docs-scraper.md", "Documentation scraping agent"),
    ("meta-agent.md", "Agent generation from specifications"),
    ("playwright-validator.md", "E2E validation with Playwright"),
    ("build-agent.md", "Parallel build delegation"),
    ("scout-report-suggest.md", "Codebase exploration and analysis"),
    ("scout-report-suggest-fast.md", "Fast codebase scouting"),
    ("planner.md", "Implementation planning"),
]
```

## Testing

### Verify BASE Agent Definitions

Check that all BASE agent definitions exist and have valid YAML:

```bash
ls -la .claude/agents/
```

Expected output: 7 agent definition files (build-agent.md, planner.md, scout-report-suggest.md, scout-report-suggest-fast.md, playwright-validator.md, meta-agent.md, docs-scraper.md)

### Verify Template Files

Check that all template files exist:

```bash
ls -la tac_bootstrap_cli/tac_bootstrap/templates/claude/agents/
```

Expected output: 7 Jinja2 template files (.md.j2 extensions)

### Validate YAML Frontmatter

Verify YAML syntax in agent definitions:

```bash
# Check BASE files have valid YAML frontmatter
head -8 .claude/agents/build-agent.md
head -8 .claude/agents/planner.md
head -8 .claude/agents/scout-report-suggest.md
```

Each should show valid YAML with required fields: name, description, tools, model, color

### Test Template Rendering

Run the test suite to verify templates render correctly:

```bash
cd tac_bootstrap_cli
uv run pytest tests/ -v --tb=short
```

### Verify Scaffold Service Registration

Check that scaffold_service.py correctly registers all agents:

```bash
grep -A 20 "Agent definitions" tac_bootstrap_cli/tac_bootstrap/application/scaffold_service.py
```

### Run Full Validation Suite

Execute all validation commands:

```bash
# Code quality checks
cd tac_bootstrap_cli
uv run ruff check .
uv run mypy tac_bootstrap/

# CLI functionality
uv run tac-bootstrap --help
```

## Notes

### Dual Location Pattern

This implementation follows the TAC-14 "dual location" pattern:
- **BASE** (.claude/agents/): Functional agent definitions for tac_bootstrap's own development
- **TEMPLATES** (templates/claude/agents/): Jinja2 templates for generating projects

This ensures both tac_bootstrap and generated projects have access to the same agent orchestration capabilities.

### Agent Orchestration Workflow

Agents work together in coordinated workflows:
1. **planner** creates strategic implementation plans
2. **scout agents** explore codebase for context
3. **build-agent** implements individual files in parallel
4. **playwright-validator** validates E2E functionality
5. **docs-scraper** fetches external documentation
6. **meta-agent** generates new agent definitions as needed

### Model Selection Rationale

- **opus**: Used for complex reasoning tasks (planning, file implementation, thorough scouting)
- **sonnet**: Balanced performance for structured tasks (validation, scraping, agent generation)
- **haiku**: Fast, cost-effective for simple tasks (quick scouting)

### TAC Version Evolution

The codebase now uses specific TAC version numbers:
- TAC-9: Documentation loading
- TAC-10: Build with report, quick planning
- TAC-11: Hooks and automation
- TAC-12: Scout-based codebase exploration
- TAC-13: Expert system integration
- TAC-14: Multi-agent orchestration (this feature)

### Future Enhancements

Potential improvements for agent orchestration:
- Dynamic agent selection based on task complexity
- Agent performance metrics and optimization
- Custom agent definition generator for project-specific needs
- Enhanced inter-agent communication protocols
- Agent swarm capabilities for massive parallel processing
